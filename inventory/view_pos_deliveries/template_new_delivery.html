<div class="add_blue_color" style="font-size:1.1em; margin:4px 16px; margin-top:12px">
  Time of Delivery
</div>
<!--hr class="add_hr_blue" style="margin:0px 16px"/-->
<div style="margin-top:-34px">
  <date-time-picker title="''" picked-time="delivery_time" picked-date="delivery_date" form-ver-date="form_ver.error_date" control="dt_control"></date-time-picker>
</div>
<div class="add_blue_color" style="font-size:1.1em; margin:4px 16px; margin-top:-14px">
  Distributor (optional)
</div>
<hr class="add_hr_blue" style="margin:0px 16px"/>
<div class="row" style="margin: 12px 0px;">
  <div class="col-xs-5">
    <div class="form-group">
      <label class="control-label optional"></label>
      <div class="btn-group" dropdown>
        <button type="button" class="btn btn-default btn-md dropdown-toggle loc_dropdown" style="font-size:1.0em; width:260px" dropdown-toggle>
          <span ng-if="new_distributor !== null" style="float:left; text-align:left; width:90%;">
            {{new_distributor.name}} 
          </span>
          <span ng-if="new_distributor === null" class="noselect" style="float:left; text-align:left; width:90%;  color:#999999">
            Select a Distributor
          </span>
          <span class="glyphicon glyphicon-triangle-bottom" style="text-align:right; margin-top:4px; font-size:12px; color:#888888"></span>
        </button>
        <ul class="loc_dropdown dropdown-menu" role="menu">
          <li class="inv_dropdown_li" ng-if="new_distributor!==null">
            <a ng-click="selectDistributor(null)" class="noselect" style="color:#aaaaaa">None</a>
          </li>
          <li class="inv_dropdown_li" ng-repeat="dist in allDistributors">
            <a ng-click="selectDistributor(dist)" class="noselect">{{dist.name}}</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col-xs-6" style="padding-top:8px" ng-show="new_distributor !== null">
    <form role="form" style="margin-top:2px">
      <input type="checkbox" id="cb_dist_bevs_only" class="customCbSqr" style="z-index:-99;" ng-click="toggleDistBevsOnly()">
        <label for="cb_dist_bevs_only">Add Beverages from this Distributor only</label>
      </input>
    </form>
  </div>
</div>

<div class="add_blue_color" style="font-size:1.1em; margin:4px 16px; margin-top:-12px">
  Beverages in this Delivery
</div>
<hr class="add_hr_blue" style="margin:0px 16px"/>
<!--div class="row" ng-if="show_add_bev_ui===false" style="margin:12px 0px">
  <div class="col-xs-2">
    <button ng-click="showAddBevInv()" type="button" class="btn btn-success btn-sm" style="font-size:14px">
      <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add Beverages
    </button>
  </div>
  <div class="col-xs-10 hint_text" ng-if="add_inv_added_bevs.length===0" style="margin-top:-4px; padding-left:28px">
    Use this button to add beverages to this delivery.<br/>
    Once added, you can record the quantities and value delivered.
  </div>
</div-->
<div ng-if="show_add_bev_ui===true" class="add_ui_box_green" style="margin:16px; width:768px">
  <div class="add_title_bar_green">
    <button ng-click="hideAddBevInv()" type="button" class="btn btn-default btn_x" style="float:left">
      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
    </button>
    <div class="add_title_green">
      <span style="font-size:1.0em;"> Add Beverages to this Delivery </span>
    </div>
    <br/>
  </div>
  <loc-add-inv loc-name="'this Delivery'" all-beverages="add_inv_unadded_bevs" control="addInvControl" add-bev-inv="addInvAddBev(bev)" show-kegs="false" show-tabs="false" list-height="280" brewery-distributor="'both'"></loc-add-inv>
</div>

<div class="row label_row_container" style="margin: 0px 16px; margin-top:16px">
  <div class="col-xs-3 inv_sort_div" ng-click="sortBy('product')">
    <button ng-if="show_add_bev_ui===false" ng-click="showAddBevInv()" type="button" class="btn btn-success btn-sm" style="margin-left:-4px; margin-top:-6px; height:32px; font-size:1.0em; position:absolute" onclick="event.preventDefault(); event.stopPropagation();">
      <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
    </button>
    <span class="inv_loc_label_span noselect" style="padding-left:40px">Product</span>
    <span class="glyphicon inv_sort_carat glyphicon-menu-down noselect" ng-show="sort_key === 'product'" ng-class="{'glyphicon-menu-down': double_sort<0, 'glyphicon-menu-up':double_sort>0}"></span>
  </div>
  <div class="col-xs-2 inv_sort_div" ng-click="sortBy('unit_cost')">
    <span class="inv_loc_label_span noselect" style="padding-top:6px; padding-bottom:6px" popover="If Unit Cost of this beverage has changed, use the edit (pencil) button to update its information in the database." popover-trigger="mouseenter" popover-append-to-body="true" popover-popup-delay="400">Unit Cost</span>
    <span class="glyphicon inv_sort_carat glyphicon-menu-down noselect" ng-show="sort_key === 'unit_cost'" ng-class="{'glyphicon-menu-down': double_sort<0, 'glyphicon-menu-up':double_sort>0}"></span>
  </div>
  <div class="col-xs-1 inv_sort_div" style="text-align:center">
    <span class="glyphicon glyphicon-question-sign" style="font-size:18px; color:#88ccdd;"  popover="If purchase information -- e.g., purchase cost or deposit -- of this beverage has changed, use the edit button to update its information in the database." popover-trigger="mouseenter" popover-append-to-body="true" popover-popup-delay="400"></span>
  </div>
  <div class="col-xs-3 inv_sort_div" ng-click="sortBy('quantity')">
    <span class="inv_loc_label_span noselect" style="padding-top:6px; padding-bottom:6px">Quantity</span>
    <span class="glyphicon inv_sort_carat glyphicon-menu-down noselect" ng-show="sort_key === 'quantity'" ng-class="{'glyphicon-menu-down': double_sort<0, 'glyphicon-menu-up':double_sort>0}"></span>
  </div>
  <div class="col-xs-2 inv_sort_div" ng-click="sortBy('inventory')" popover="Inventory = Quantity * Unit Cost + Deposit.  The cost of beverages can be edited in the All Beverages DB." popover-trigger="mouseenter" popover-append-to-body="true" popover-popup-delay="400">
    <span class="inv_loc_label_span noselect" style="padding-top:6px; padding-bottom:6px">Total Price</span>
    <span class="glyphicon inv_sort_carat glyphicon-menu-down noselect"ng-show="sort_key === 'inventory'" ng-class="{'glyphicon-menu-down': double_sort<0, 'glyphicon-menu-up':double_sort>0}"></span>
  </div>
</div>
<div class="row" ng-if="add_inv_added_bevs.length===0" style="margin: 0px 16px; background-color:white; padding: 24px 2px; padding-top:16px">
  <div class="col-xs-12 hint_text" style="font-size:1.2em; font-style:italic">
    Use the "<span style="font-weight:bold; font-size:20px">+</span>" button to add beverages to this delivery.
  </div>    
</div>
<div ng-repeat="inv in add_inv_added_bevs">
  <div class="min_padding row inv_row_container" ng-class-even="'inv_row_even'" ng-class-odd="'inv_row_odd'" style="margin:0px 16px;">
    <div class="col-xs-3 min_padding" style="padding-top:6px;">
      <div style="font-size:1.1em; padding-left:6px; margin-top:-6px">
        {{inv.product}}
      </div>
      <div style="font-size:0.9em; color:#999999; padding-left:6px;"> 
        <!--span ng-if="inv.type==='keg'">{{inv.distributor}}</span-->
        <span ng-if="inv.type==='keg'">Empty </span>
        <span ng-if="inv.purchase_volume!==null">{{inv.purchase_volume | number:1}} {{inv.purchase_unit}}</span>
        <span ng-if="inv.type==='bev'">{{inv.container_type}}</span>
        <span ng-if="inv.type==='keg'">Keg</span>
      </div>
    </div>
    <!--div class="col-xs-3 min_padding inv_col" style="padding-top:6px">
      <span ng-if="inv.type==='bev'">{{inv.brewery}}</span>
      <span ng-if="inv.type==='keg'">{{inv.distributor}}</span>
    </div-->
    <div class="col-xs-2 min_padding" style="padding-top:8px;">
      <div ng-if="inv.deposit !== null" style="font-size:1.1em; padding-left:6px; margin-top:-6px">$ {{inv.unit_cost | number:2}}</div>
      <div ng-if="inv.deposit !== null" style="font-size:0.9em; color:#999999; padding-left:6px;"> $ {{inv.deposit | number:2}} Dpst.</div>
      <div ng-if="inv.deposit === null" style="font-size:1.1em; padding-left:2px">$ {{inv.unit_cost | number:2}}</div>
    </div>
    <div class="col-xs-1 min_padding" style="text-align:center">
      <button ng-click="editBev($index)" type="button" class="btn btn-md btn_frameless hover_green" style="font-size:14px; min-height:32px;">
        <span class="glyphicon glyphicon-pencil"></span>
      </button>
    </div>
    <div class="min_padding col-xs-3">
      <button ng-click="addQuantity(inv,-1)" type="button" class="btn btn-default inv_minus_btn">
        <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
      </button>
      <div class="form" ng-class="{'has-error': form_ver.errors_qty[$index]===true}">
        <input ng-model="inv.quantity" ng-class="{'input_error': inv.invalid_quantity===true}" ng-change="addInvQtyChanged(inv)" class="form-control" style="display:inline-block; float:left; text-align:center; max-width:64px; height:38px; font-size:1.3em;">
      </div>
      <button ng-click="addQuantity(inv,1)" type="button" class="btn btn-default inv_plus_btn">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
      </button>
    </div>
    <div class="min_padding col-xs-2">
      <div style="padding-left:4px; padding-top:8px; display:inline-block; float:left; font-size:1.1em">
        <span style="vertical-align:top">$ {{inv.inventory | number:2}}</span>
      </div>
    </div>
    <div class="col-xs-1 min_padding" style="text-align:right">
      <button ng-click="removeInvItem($index)" type="button" class="btn btn-default btn-sm btn-right" style="font-size:14px; min-height:32px; color:#888888">
        <span class="glyphicon glyphicon-trash" aria-hidden="true" style="color:#aaaaaa"></span>
      </button>
    </div>
  </div>
</div>
<hr style="margin: 0px 16px; border-color:#eeeeee"/>
<div ng-if="add_inv_added_bevs.length > 0" class="row" style="margin:0px 16px; padding-top:12px; padding-bottom:12px; font-size:1.1em; border-bottom:solid 2px #e0f0ff" ng-class="{'inv_row_even':(add_inv_added_bevs.length%2)==1, 'inv_row_odd':(add_inv_added_bevs.length%2)==0}">
  <div class="col-xs-9 min_padding" style="text-align:right;">Delivery Total:</div>
  <div class="col-xs-3 min_padding" style="padding-left:8px">$ {{add_grand_total | number:2}}</div>
</div>
<div ng-show="new_failure_msg !== null" class="row" style="margin:0px 16px; margin-top:12px">
  <div class="alert alert-danger" data-html="true" role="alert" style="margin-bottom:6px">
    {{new_failure_msg}}
  </div>
</div>
<div class="row" style="margin: 12px 0px">
  <div class="col-xs-12">
    <button ng-click="saveDelivery()" type="button" class="btn btn-primary btn_ok" ng-disabled="add_inv_added_bevs.length===0">
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Save New Delivery
    </button>
  </div>
</div>
<div class="min_padding" style="margin-bottom:16px"></div>